# Lecture 16: Networking and Sockets (Part II)

## Announcements

Can we see how a paragraph looks like? This is a test.

- **Project 3 is out**
- **Quiz 8 is due tomorrow on Canvas**
  - Final submission reminder: April 7th
- **Midterm 2** on March 30th in class
  - Same format and policies as Midterm 1
  - Practice questions available on Canvas
- Logistical questions

## Introduction to Sockets

- Sockets are crucial for systems programming and serve as the API for sending and receiving data over the Internet.
- Comparison to pipes:
  - Similarities: Two processes sending and receiving bytes.
  - Differences: Sockets allow communication across the world.
- Key concepts:
  - Setting up connections, reading/writing data, closing connections remain relevant.
- TCP sockets introduce blocking behavior similar to pipe behavior.

## Network Basics

- **IP & IP Addresses**: Identifying which computer to connect to.
- Unique characteristics of sockets:
  - Assurance of message delivery.
  - Data structure and parsing rules.

### Networking Layers

1. **Physical Layer**: Copper wires and radio waves.
2. **Link Layer**: Connects adjacent nodes, e.g., Wi-Fi.
3. **Network Layer**: IP protocol for routing.
4. **Transport Layer**: TCP/UDP choices affecting how data is handled.

- **Narrow Waist Concept**: One common protocol (IP) for routing through various link technologies (satellite, fiber-optics, etc.).
- Both TCP and UDP operate over IP.

### IP Addressing

- Each computer has a unique IP address.
- **IP Version 4 (IPv4)**: 32-bit addresses.
- **IP Version 6 (IPv6)**: 128-bit addresses, allowing for a vastly larger address space (10^38 addresses).
- Transitioning from IPv4 to IPv6 due to address exhaustion.

### Transport Protocols

- **UDP (User Datagram Protocol)**: Lightweight, provides minimal overhead but lacks reliability.
- **TCP (Transmission Control Protocol)**: Guarantees reliable, ordered communication but is heavier and requires more overhead.
- Common analogy:
  - **UDP**: Like sending a letter (no feedback).
  - **TCP**: Like a phone call (establishing a connection, feedback).

## Discussion Activity: Protocols for Specific Scenarios

1. Copying a file from one computer to another.

   - Predominantly TCP for reliable delivery.

2. Webpage loading.

   - Both TCP and UDP were argued, but TCP is commonly preferred for reliability.

3. Instant messaging/chat.

   - Preference for TCP for complete delivery; some pushed for UDP for speed.

4. Video conferencing (e.g., Zoom).

   - UDP favored for speed; TCP also mentioned for reliability.

5. Streaming audio (e.g., Spotify).

   - Opinions were split; UDP recommended for less risk of buffering.

6. Streaming video (e.g., Netflix).
   - General consensus leaned towards TCP for quality assurance.

### Key Learning: Understanding Practical Use Cases

- Protocol choice depends on application requirements (reliability vs. speed).

## Building Blocks of Networking

- **DNS (Domain Name System)**: Maps human-friendly names to IP addresses.
  - Operates mostly with UDP due to small data exchanges.
  - Applications typically complete DNS lookups automatically.
- **Ports**: Disambiguate traffic on the computer.
  - Different services bind to well-known ports (e.g., HTTP - 80, HTTPS - 443).
  - Ports can be ephemeral when used by clients.

## Client-Server Model

- **Client**: Initiates communication with a server using IP and port.
- **Server**: Listens on a port for requests and responds.

### Steps in Website Access

1. **DNS Lookup**: Resolve domain name to IP.
2. **HTTP Request**: Use resolved IP to send requests to the appropriate port.
3. **Response Handling**: Process and render the HTML/CSS/JavaScript.

## Socket Programming

- **Creating Sockets**: Utilize the `socket()` function.
  - Takes parameters for domain (IPv4/IPv6), type (TCP/UDP).
  - Returns file descriptor for further operations.

### Using getaddrinfo

- Call to retrieve address information.
- Setup involves structs for hints and results.
- Complexity of proper memory management using pointers.

## Sending and Receiving Data

- **sendto()**:
  - Sends a message to specified IP and port.
- **recvfrom()**:
  - Receives a message and provides sender information.

### Demonstration of UDP Client Code

- Basic structure for building a UDP client.
- Integration of command-line arguments for destination address and port.

### Final Notes

- Emphasis on learning the underlying concepts of networking will aid in building effective applications.
- Importance of using correct protocols based on application demands.

## Q&A Session

- Open floor for student questions and clarifications.

### Conclusion

- Understanding sockets, protocols, and the client-server model enhances the ability to develop network applications effectively.
